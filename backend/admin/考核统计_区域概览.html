<style>
    .contract{
        position: relative;
    }
    .more{
        position: absolute;
        top:10px;
        right:80px;
        z-index:1000;
        display: none;
    }
    .btn:not(.btn-sm):not(.btn-lg){
        line-height: 0.8;
    }
    @media (min-width: 992px){
        .all {
            width: 1000px;
        }
    }
    .modal, .modal-open, .scroll{
        overflow-y: hidden!important;
    }
    .btn.btn-outline.dark {
        color: #FFF;
        background-color: #32c5d2;
        border-color: #32c5d2;
    }
    .modal-header{
        position: relative;
    }
    .data{
        position: absolute;
        top:10px;
        right:50px;
    }
</style>
<div class="clearfix" style="background-color: #dbdbdb; margin: 15px;">
    <div class="actions col-md-12" style="margin: 20px 3px;">
        <div id="dataPicker_zx_qytj" class="input-group input-large date-picker input-daterange"
             data-date="2016-08"
             data-date-format="yyyy-mm-dd" data-date-minviewmode="months">
            <label class="date-select-label">数据看板</label>
            <input type="text" class="date-select-input form-control" name="look-date" value="">
        </div>
    </div>
    <div class="col-md-3">
        <div class="dashboard-stat2 ">
            <div class="display">
                <div class="number">
                    <h3 class="font-green-sharp">
                        <span data-counter="counterup" data-value="70">70<small> / 1412</small></span>
                    </h3>
                    <small>签约人数</small>
                </div>
                <div class="icon">
                    <i class="icon-pie-chart"></i>
                </div>
            </div>
            <div class="progress-info">
                <div class="progress">
                    <span style="width: 100%;" class="progress-bar progress-bar-success green-sharp">
                        <span class="sr-only">76% progress</span>
                    </span>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="dashboard-stat2 ">
            <div class="display">
                <div class="number">
                    <h3 class="font-red-haze">
                        <span data-counter="counterup" data-value="55">55<small> / 675</small></span>
                    </h3>
                    <small>绑定人数</small>
                </div>
                <div class="icon">
                    <i class="icon-pie-chart"></i>
                </div>
            </div>
            <div class="progress-info">
                <div class="progress">
                    <span style="width: 100%;" class="progress-bar progress-bar-success red-haze">
                        <span class="sr-only">85% change</span>
                    </span>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="dashboard-stat2 ">
            <div class="display">
                <div class="number">
                    <h3 class="font-blue-sharp">
                        <span data-counter="counterup" data-value="88">88<small> / 328</small></span>
                    </h3>
                    <small>预约人数</small>
                </div>
                <div class="icon">
                    <i class="icon-pie-chart"></i>
                </div>
            </div>
            <div class="progress-info">
                <div class="progress">
                    <span style="width: 100%;" class="progress-bar progress-bar-success blue-sharp">
                        <span class="sr-only">100% grow</span>
                    </span>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="dashboard-stat2 ">
            <div class="display">
                <div class="number">
                    <h3 class="font-purple-soft">
                        <span data-counter="counterup" data-value="69">69 <small> / 987</small></span>
                    </h3>
                    <small>居民咨询</small>
                </div>
                <div class="icon">
                    <i class="icon-pie-chart"></i>
                </div>
            </div>
            <div class="progress-info">
                <div class="progress">
                    <span style="width: 100%;" class="progress-bar progress-bar-success purple-soft">
                        <span class="sr-only">100% change</span>
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="col-md-6">
    <div class="portlet light portlet-fit ">
        <div class="portlet-title">
            <div class="caption">
                <span class="caption-subject bold">区域总计签约及微信绑定情况</span>
            </div>
        </div>
        <div class="portlet-body ">
            <div id="qy_wx" style="height:300px;"></div>
        </div>
    </div>
</div>
<div class="col-md-6">
    <div class="portlet light portlet-fit ">
        <div class="portlet-title">
            <div class="caption">
                <span class="caption-subject bold">各中心签约及微信绑定情况</span>
            </div>
            <div class="actions" style="float: right">
                <div id="dataPicker_zx_wx" class="input-group input-large date-picker input-daterange"
                     data-date="2016-08"
                     data-date-format="yyyy-mm" data-date-minviewmode="months">
                    <input type="text" class="form-control" name="from1" value="">
                    <span class="input-group-addon"> 至 </span>
                    <input type="text" class="form-control" name="to1" value="">
                </div>
            </div>
        </div>
        <div class="portlet-body contract">
            <button id="more1" type="button" class="btn btn-circle btn-primary more" data-toggle="modal"
                    href="#addmoda5">
               更多
            </button>
            <div id="zx_wx" style="height:300px;"></div>
        </div>
    </div>
</div>
<div class="col-md-6">
    <div class="portlet light portlet-fit ">
        <div class="portlet-title">
            <div class="caption">
                <span class="caption-subject bold">区域总计服务情况</span>
            </div>
        </div>
        <div class="portlet-body">
            <div id="qy_fw" style="height:300px;"></div>
        </div>
    </div>
</div>
<div class="col-md-6">
    <div class="portlet light portlet-fit ">
        <div class="portlet-title">
            <div class="caption">
                <span class="caption-subject bold">各中心服务情况</span>
            </div>
            <div class="actions" style="float: right">
                <div id="dataPicker_zx_fw" class="input-group input-large date-picker input-daterange"
                     data-date="2016-08"
                     data-date-format="yyyy-mm" data-date-minviewmode="months">
                    <input type="text" class="form-control" name="from1" value="">
                    <span class="input-group-addon"> 至 </span>
                    <input type="text" class="form-control" name="to1" value="">
                </div>
            </div>
        </div>
        <div class="portlet-body contract">
            <button id="more2" type="button" class="btn btn-circle btn-primary more" data-toggle="modal"
                    href="#addmoda6">
                更多
            </button>
            <div id="zx_fw" style="height:300px;"></div>
        </div>
    </div>
</div>
<div style="clear: both"></div>
<div class="modal fade bs-modal-lg scroll " id="addmoda5" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg all">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">各中心签约及微信绑定情况</h4>
                <div class="actions data" style="float: right">
                    <div id="dataPicker_zx_wx1" class="input-group input-large date-picker input-daterange" data-date="2016-08" data-date-format="yyyy-mm" data-date-minviewmode="months">
                        <input type="text" class="form-control" name="from1" value="">
                        <span class="input-group-addon"> 至 </span>
                        <input type="text" class="form-control" name="to1" value="">
                    </div>
                </div>
            </div>
            <div class="modal-body">
                <div id="sx_wx" style="width: 970px;height:500px;"></div>
            </div>
            <div class="modal-footer">
                <button type="button" data-dismiss="modal" class="btn dark btn-outline">关闭</button>
                <!--<button type="button" class="btn green">确定</button>-->
            </div>
        </div>
    </div>
</div>
<div class="modal fade bs-modal-lg scroll " id="addmoda6" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg all">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">各中心服务情况</h4>
                <div class="actions data" style="float: right">
                    <div id="dataPicker_zx_wx2" class="input-group input-large date-picker input-daterange" data-date="2016-08" data-date-format="yyyy-mm" data-date-minviewmode="months">
                        <input type="text" class="form-control" name="from1" value="">
                        <span class="input-group-addon"> 至 </span>
                        <input type="text" class="form-control" name="to1" value="">
                    </div>
                </div>
            </div>
            <div class="modal-body">
                <div id="gx_fw" style="width: 970px;height:500px;"></div>
            </div>
            <div class="modal-footer">
                <button type="button" data-dismiss="modal" class="btn dark btn-outline">关闭</button>
                <!--<button type="button" class="btn green">确定</button>-->
            </div>
        </div>
    </div>
</div>

<script src="../assets/global/plugins/echarts/echarts.js" type="text/javascript"></script>
<script>
    $(function () {
        var date = new Date();
        var m1 = date.getFullYear() + "-" + (date.getMonth() + 1);
        var fromTime = $("input[name='from1']");
        var toTime = $("input[name='to1']");
        fromTime.val("2016-08");
        toTime.val(m1);

        $('#dataPicker_zx_wx,#dataPicker_zx_fw,#dataPicker_zx_wx1,#dataPicker_zx_wx2').datepicker({
            rtl: false,
            orientation: "left",
            autoclose: true,
            minViewMode: 1,
            maxViewMode: 2,
            startDate: "2016-08",
            endDate: m1
        }).on('changeDate', function (e) {
            var from = $(this).find("input[name='from1']");
            var to = $(this).find("input[name='to1']");
            var id = this.id.substring(11);
            alert(from.val() + "至" + to.val() + " " + id);
        });

        var month = date.getMonth() + 1;
        if(month < 10) {
            month = "0" + month;
        }
        var n = date.getFullYear() + "-" + month + "-" + date.getDate();
        var lookDate = $("input[name='look-date']");
        lookDate.val(n);

        $('#dataPicker_zx_qytj').datepicker({
            autoclose: true,
            startDate: "2016-08-31",
            endDate: n
        }).on('changeDate', function (e) {
            alert(n);
        });

        require.config({paths: {echarts: "../assets/global/plugins/echarts/"}}),
            require(["echarts", "echarts/chart/bar", "echarts/chart/line"], function (e) {
                var zx_wx = e.init(document.getElementById("zx_wx"));
                var option1 = {
                    tooltip: {trigger: "axis",
                        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                            type : 'line'        // 默认为直线，可选为：'line' | 'shadow'
                        }
                    },
                    legend: {data: ["签约", "微信绑定"]},
                    toolbox: {
                        show: !0,
                        feature: {
                            restore: {show: !0},
                            saveAsImage: {show: !0}
                        }
                    },
                    calculable: !0,
                    xAxis: [{
                        type: "category",
                        data: ["观前街道观前街道观观前街道观前街道观道观前街道观", "留园街道", "金阊街道", "吴门桥街道","观前街道", "留园街道","观前街道", "留园街道", "留园街道","观前街道", "留园街道"],
                        axisLabel : {
                            interval : 0,
                            formatter : function(params){
                                var newParamsName = "";
                                var paramsNameNumber = params.length;
                                var provideNumber = 5;
                                var rowNumber = Math.ceil(paramsNameNumber / provideNumber);
                                if (paramsNameNumber > provideNumber) {
                                    for (var p = 0; p < rowNumber; p++) {
                                        var tempStr = "";
                                        var start = p * provideNumber;
                                        var end = start + provideNumber;
                                        if (p == rowNumber - 1) {
                                            tempStr = params.substring(start, paramsNameNumber);
                                        } else {
                                            tempStr = params.substring(start, end) + "\n";
                                        }
                                        newParamsName += tempStr;
                                    }

                                } else {
                                    newParamsName = params;
                                }
                                return newParamsName
                            }

                        }
                    }],
                    grid:{
                        y2: 80,
                    },
                    yAxis: [{type: "value", splitArea: {show: !0}}],
                    series: [
                        {
                            name: "签约",
                            type: "bar",
                            data: [124, 139, 214, 145, 139, 214, 139, 214]
                        },
                        {
                            name: "微信绑定",
                            type: "bar",
                            data: [156, 192, 231, 137, 192, 231, 192, 231]
                        }]
                };
                let more1 = document.querySelector("#more1");
//                如果显示大于8，显现更多，当前页面只显示8个数据
                if(option1.xAxis[0].data.length>8){
                    more1.style.cssText = 'display:block';
                    var data1 = option1.xAxis[0].data.slice(0,8);
                    option1.xAxis[0].data = data1;
                }
                zx_wx.setOption(option1);

//                隐藏页面 显示更多
                var sx_wx = e.init(document.getElementById("sx_wx"));
                var option={
                    tooltip: {trigger: "axis",
                        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                            type : 'line'        // 默认为直线，可选为：'line' | 'shadow'
                        }
                    },
                    legend: {data: ["签约", "微信绑定"]},
                    toolbox: {
                        show: !0,
                        feature: {
                            restore: {show: !0},
                            saveAsImage: {show: !0}
                        }
                    },
                    calculable: !0,
                    xAxis: [{
                        type: "category",
                        data: ["观前街道观前街道观前街道观前街道观前街道观前街道", "观前街道", "留园街道","吴门桥街道","观前街道", "留园街道","观前街道", "留园街道", "金阊街道", "吴门桥街道","观前街道", "留园街道", "吴门桥街道","观前街道", "留园街道"],
                        axisLabel : {
                            interval : 0,
                            formatter : function(params,long){
                                var newParamsName = "";
                                var paramsNameNumber = params.length;
                                var provideNumber = nub1;
                                var rowNumber = Math.ceil(paramsNameNumber / provideNumber);
                                if (paramsNameNumber > provideNumber) {
                                    for (var p = 0; p < rowNumber; p++) {
                                        var tempStr = "";
                                        var start = p * provideNumber;
                                        var end = start + provideNumber;
                                        if (p == rowNumber - 1) {
                                            tempStr = params.substring(start, paramsNameNumber);
                                        } else {
                                            tempStr = params.substring(start, end) + "\n";
                                        }
                                        newParamsName += tempStr;
                                    }

                                } else {
                                    newParamsName = params;
                                }
                                return newParamsName
                            }

                        }
                    }],
                    grid:{
                        y2: 100,
                    },
                    yAxis: [{type: "value", splitArea: {show: !0}}],
                    series: [
                        {
                            name: "签约",
                            type: "bar",
                            data: [124, 139, 214, 145, 139, 214,124, 139, 214, 145, 139, 214]
                        },
                        {
                            name: "微信绑定",
                            type: "bar",
                            data: [156, 192, 231, 137, 192, 231,124, 139, 214, 145, 139, 214]
                        }]
                };
                var height1;
                var nub1;
                if(option.xAxis[0].data.length<=15){
                    nub1 = 4;
                }else if(15<option.xAxis[0].data.length && option.xAxis[0].data.length<=20){
                    nub1 = 3;
                    height1 = 130;
                    option.grid.y2 = height1;
                }else{
                    nub1 = 2;
                    height1 = 200;
                    option.grid.y2 = height1;
                }

                sx_wx.setOption(option);


                var zx_fw = e.init(document.getElementById("zx_fw"));
                var option2 = {
                    tooltip: {trigger: "axis",
                        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                            type : 'line'        // 默认为直线，可选为：'line' | 'shadow'
                        }
                    },
                    legend: {data: ["咨询", "预约上门", "家庭病床申请家庭", "随访筛查", "社区巡诊"]},
                    toolbox: {
                        show: !0,
                        feature: {
                            restore: {show: !0},
                            saveAsImage: {show: !0}
                        }
                    },
                    calculable: !0,
                    xAxis: [{
                        type: "category",
                        data: ["观前街道观前街道", "留园街道", "金阊街道", "吴门桥街道","观前街道", "留园街道", "金阊街道", "吴门桥街道","观前街道", "留园街道", "金阊街道"],
                        axisLabel : {
                            interval : 0,
                            formatter : function(params){
                                var newParamsName = "";
                                var paramsNameNumber = params.length;
                                var provideNumber = 5;
                                var rowNumber = Math.ceil(paramsNameNumber / provideNumber);
                                if (paramsNameNumber > provideNumber) {
                                    for (var p = 0; p < rowNumber; p++) {
                                        var tempStr = "";
                                        var start = p * provideNumber;
                                        var end = start + provideNumber;
                                        if (p == rowNumber - 1) {
                                            tempStr = params.substring(start, paramsNameNumber);
                                        } else {
                                            tempStr = params.substring(start, end) + "\n";
                                        }
                                        newParamsName += tempStr;
                                    }

                                } else {
                                    newParamsName = params;
                                }
                                return newParamsName
                            }

                        }
                    }],
                    grid:{
                        y2: 80,
                    },
                    yAxis: [{type: "value", splitArea: {show: !0}}],
                    series: [
                        {
                            name: "咨询",
                            type: "bar",
                            data: [165, 224, 155, 179,165, 224, 155, 179, 224, 155, 179]
                        },
                        {
                            name: "预约上门",
                            type: "bar",
                            data: [146, 154, 140, 138,146, 154, 140, 138, 224, 155, 179]
                        },
                        {
                            name: "家庭病床申请家庭",
                            type: "bar",
                            data: [88, 67, 111, 86,88, 67, 111, 86, 224, 155, 179]
                        },
                        {
                            name: "随访筛查",
                            type: "bar",
                            data: [88, 67, 111, 86,88, 67, 111, 86]
                        },
                        {
                            name: "社区巡诊",
                            type: "bar",
                            data: [88, 67, 111, 86,88, 67, 111, 86]
                        }
                    ]
                };
                let more2 = document.querySelector("#more2");
 //                如果显示大于8，显现更多，当前页面只显示8个数据
                if(option2.xAxis[0].data.length>8){
                    more2.style.cssText = 'display:block';
                    var data2 = option2.xAxis[0].data.slice(0,8);
                    option2.xAxis[0].data = data2;
                }
                zx_fw.setOption(option2);

//                隐藏页面  显示更多
                var gx_fw = e.init(document.getElementById("gx_fw"));
                var option3 = {
                    tooltip: {trigger: "axis",
                        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                            type : 'line'        // 默认为直线，可选为：'line' | 'shadow'
                        }
                    },
                    legend: {data: ["咨询", "预约上门", "家庭病床申请家庭", "随访筛查", "社区巡诊"]},
                    toolbox: {
                        show: !0,
                        feature: {
                            restore: {show: !0},
                            saveAsImage: {show: !0}
                        }
                    },
                    calculable: !0,
                    xAxis: [{
                        type: "category",
                        data: ["观前街道观前街道", "金阊街道","金阊街道", "吴门桥街道","观前街道观前街道", "留园街道", "留园街道", "吴门桥街道","观前街道观前街道", "留园街道", "留园街道", "金阊街道","金阊街道", "吴门桥街道","观前街道观前街道", "留园街道", "留园街道", "金阊街道", "吴门桥街道","观前街道", "留园街道","金阊街道", "吴门桥街道", "金阊街道", "吴门桥街道"],
                        axisLabel : {
                            interval : 0,
                            formatter : function(params){
                                var newParamsName = "";
                                var paramsNameNumber = params.length;
                                var provideNumber = nub;
                                var rowNumber = Math.ceil(paramsNameNumber / provideNumber);
                                if (paramsNameNumber > provideNumber) {
                                    for (var p = 0; p < rowNumber; p++) {
                                        var tempStr = "";
                                        var start = p * provideNumber;
                                        var end = start + provideNumber;
                                        if (p == rowNumber - 1) {
                                            tempStr = params.substring(start, paramsNameNumber);
                                        } else {
                                            tempStr = params.substring(start, end) + "\n";
                                        }
                                        newParamsName += tempStr;
                                    }

                                } else {
                                    newParamsName = params;
                                }
                                return newParamsName
                            }

                        }

                    }],
                    yAxis: [{type: "value", splitArea: {show: !0}}],
                    series: [
                        {
                            name: "咨询",
                            type: "bar",
                            data: [165, 224, 155, 179,165, 224, 155, 179]
                        },
                        {
                            name: "预约上门",
                            type: "bar",
                            data: [146, 154, 140, 138,146, 154, 140, 138]
                        },
                        {
                            name: "家庭病床申请家庭",
                            type: "bar",
                            data: [88, 67, 111, 86,88, 67, 111, 86]
                        },
                        {
                            name: "随访筛查",
                            type: "bar",
                            data: [88, 67, 111, 86,88, 67, 111, 86]
                        },
                        {
                            name: "社区巡诊",
                            type: "bar",
                            data: [88, 67, 111, 86,88, 67, 111, 86]
                        }
                    ],
                    grid:{
                        y2: 100,
                    },
                };
                var nub;
                var height2;
                if(option3.xAxis[0].data.length<=15){
                    nub = 4;
                }else if(15<option3.xAxis[0].data.length && option3.xAxis[0].data.length<=20){
                    nub = 3;
                    height2 = 130;
                    option3.grid.y2 = height2;
                }else{
                    nub = 2;
                    height2 = 200;
                    option3.grid.y2 = height2;
                }
                gx_fw.setOption(option3);


                var qy_wx = e.init(document.getElementById("qy_wx"));
                qy_wx.setOption({
                    tooltip: {trigger: "axis",
                        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                            type : 'line'        // 默认为直线，可选为：'line' | 'shadow'
                        }
                    },
                    legend: {data: ["签约", "微信绑定"]},
                    toolbox: {
                        show: !0,
                        feature: {
                            restore: {show: !0},
                            saveAsImage: {show: !0}
                        }
                    },
                    calculable: !0,
                    xAxis: [{
                        type: "category",
                        boundaryGap: !1,
                        data: ["16年1月", "16年2月", "16年3月", "16年4月", "16年5月", "16年6月"]
                    }],
                    yAxis: [{type: "value", axisLabel: {formatter: "{value}"}}],
                    series: [{
                        name: "签约",
                        type: "line",
                        data: [210, 212, 253, 234, 325, 235],
                        markPoint: {data: [{type: "max", name: "最高"}, {type: "min", name: "最低"}]},
                        markLine: {data: [{type: "average", name: "平均"}]}
                    }, {
                        name: "微信绑定",
                        type: "line",
                        data: [198, 188, 176, 186, 173, 184],
                        markPoint: {data: [{type: "max", name: "最高"}, {type: "min", name: "最低"}]},
                        markLine: {data: [{type: "average", name: "Mean"}]}
                    }]
                });
                var qy_fw = e.init(document.getElementById("qy_fw"));
                qy_fw.setOption({
                    tooltip: {trigger: "axis",
                        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                            type : 'line'        // 默认为直线，可选为：'line' | 'shadow'
                        }
                    },
                    legend: {data: ["回复咨询", "完成上门", "家庭病床成功建床", "随访筛查", "社区巡诊"]},
                    toolbox: {
                        show: !0,
                        feature: {
                            restore: {show: !0},
                            saveAsImage: {show: !0}
                        }
                    },
                    calculable: !0,
                    xAxis: [{
                        type: "category",
                        boundaryGap: !1,
                        data: ["16年1月", "16年2月", "16年3月", "16年4月", "16年5月", "16年6月"]
                    }],
                    yAxis: [{type: "value", axisLabel: {formatter: "{value}"}}],
                    series: [{
                        name: "回复咨询",
                        type: "line",
                        data: [120, 312, 253, 134, 225, 335],
                        markPoint: {data: [{type: "max", name: "最高"}, {type: "min", name: "最低"}]},
                        markLine: {data: [{type: "average", name: "平均"}]}
                    }, {
                        name: "完成上门",
                        type: "line",
                        data: [134, 225, 335, 286, 173, 658],
                        markPoint: {data: [{type: "max", name: "最高"}, {type: "min", name: "最低"}]},
                        markLine: {data: [{type: "average", name: "Mean"}]}
                    }, {
                        name: "家庭病床成功建床",
                        type: "line",
                        data: [222, 111, 234, 135, 232, 321],
                        markPoint: {data: [{type: "max", name: "最高"}, {type: "min", name: "最低"}]},
                        markLine: {data: [{type: "average", name: "Mean"}]}
                    }, {
                        name: "随访筛查",
                        type: "line",
                        data: [222, 111, 234, 135, 232, 321],
                        markPoint: {data: [{type: "max", name: "最高"}, {type: "min", name: "最低"}]},
                        markLine: {data: [{type: "average", name: "Mean"}]}
                    }, {
                        name: "社区巡诊",
                        type: "line",
                        data: [222, 111, 234, 135, 232, 321],
                        markPoint: {data: [{type: "max", name: "最高"}, {type: "min", name: "最低"}]},
                        markLine: {data: [{type: "average", name: "Mean"}]}
                    }]
                });
            })
    });
</script>