<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <title>营养资讯</title>
    <link rel="stylesheet" href="../css/weui.min.css"/>
    <link rel="stylesheet" href="../css/f.css"/>
    <link rel="stylesheet" href="../css/swiper.min.css"/>
    <style>
        body {
            padding: 0;
            margin: 0
        }
        .swiper-slide {
            width: auto!important;
            height: 40px;
        }
        .swiper-slide:last-child {
            margin-right: 30px;
        }
        .swiper-slide.active {
            border-bottom: 2px solid #1aad19;
            color: #1aad19;
        }
        .topmenu {
            height: 42px;
            background-color: white;
            padding: 0 10px;
            line-height: 42px;
            font-family: "微软雅黑";
            position: relative;
        }
        .topmenu .edit_channel_btn {
            position: absolute;
            right:0;
            top: 0;
            /*padding: 0 7px;*/
            /*background-color: #fff;*/
            z-index: 1;
            font-size: 20px;
            background: url("../images/@2x/icon@2x.png") center no-repeat;
            background-size: 100%;
            width: 38px;
            height: 42px;
        }
        .yyzx_list {
            margin-top: 42px;
        }
        .yyzxRecord .weui-panel {
            margin-top: 0px;
            margin-bottom: 8px;
        }
        .yyzxRecord .weui-media-box__desc {
            display: inline-block;
        }
        .yyzxRecord a .weui-media-box__hd {
            width: 100px;
            height: 80px;
            line-height: 80px;
            position: relative;
        }
        .yyzxRecord a .weui-media-box__bd {
            height: 80px;
            margin-right: 15px;
            color: #707070;
            font-weight: 400;
        }
        .yyzx_title {
            display: -webkit-box; /** 对象作为伸缩盒子模型显示 **/
            -webkit-box-orient: vertical; /** 设置或检索伸缩盒对象的子元素的排列方式 **/
            -webkit-line-clamp: 2; /** 显示的行数 **/
            white-space: normal;
            font-size: 16px;
            color: #333;
        }
        .yyzx_info {
            position: absolute;
            bottom: 8px;
        }
        .yyzx_info .yyzx_desc {
            width: 120px;
        }
        .yyzx_info .yyzx_look {
            line-height: 13px;
            font-size: 13px;
            color: #999;
            text-indent: 0!important;
        }
        .yyzx_info .yyzx_look img {
            height: 13px;
            vertical-align: middle;
            margin-right: 5px;
            margin-bottom: 2px;
        }
    </style>
</head>
<body class="yyzxRecord" ontouchstart>

<!-- Swiper -->
<div class="topmenu">
    <div class="swiper-container">
        <div class="swiper-wrapper">
            <span class="swiper-slide" onclick="clickTab(0)">儿童</span>
            <span class="swiper-slide" onclick="clickTab(1)">高血压</span>
            <span class="swiper-slide" onclick="clickTab(2)">高血脂</span>
            <span class="swiper-slide" onclick="clickTab(3)">糖尿病</span>
            <span class="swiper-slide" onclick="clickTab(4)">老年人</span>
            <span class="swiper-slide" onclick="clickTab(5)">孕妇</span>
            <span class="swiper-slide" onclick="clickTab(6)">残疾人</span>
            <span class="swiper-slide" onclick="clickTab(7)">高血糖</span>
        </div>
    </div>
    <span class="edit_channel_btn"></span>
</div>

<div id="wrapper" class="yyzx_list">
    <div id="scroller" style="width: 100.5%;">
        <div id="pullDown">
            <span class="pullDownLabel">下拉刷新...</span>
        </div>
        <div class="weui-panel weui-panel_access">
            <div id="thelist" class="weui-panel__bd">
                <a class="weui-media-box weui-media-box_appmsg" href="营养资讯_详情.html">
                    <div class="weui-media-box__bd">
                        <h4 class="weui-media-box__title yyzx_title">糖尿病心肌病治疗糖尿病心肌病治疗糖尿病心肌病治疗糖尿病心肌病治疗心肌病治疗</h4>
                        <div class="yyzx_info">
                            <p class="weui-media-box__desc yyzx_desc">2017年6月6日</p>
                            <div class="weui-media-box__desc yyzx_look">
                                <img src="../images/look.png">191
                            </div>
                        </div>
                    </div>
                    <div class="weui-media-box__hd">
                        <img class="weui-media-box__thumb" src="../images/zixun2.jpg">
                    </div>
                </a>
                <a class="weui-media-box weui-media-box_appmsg" href="营养资讯_详情.html">
                    <div class="weui-media-box__bd">
                        <h4 class="weui-media-box__title yyzx_title">糖尿病心肌病治疗糖尿病心肌病</h4>
                        <div class="yyzx_info">
                            <p class="weui-media-box__desc yyzx_desc">2017年6月6日</p>
                            <div class="weui-media-box__desc yyzx_look">
                                <img src="../images/look.png">191
                            </div>
                        </div>
                    </div>
                    <div class="weui-media-box__hd">
                        <img class="weui-media-box__thumb" src="../images/zixun2.jpg">
                    </div>
                </a>
                <a class="weui-media-box weui-media-box_appmsg" href="营养资讯_详情.html">
                    <div class="weui-media-box__bd">
                        <h4 class="weui-media-box__title yyzx_title">糖尿病心肌病治疗糖尿病心肌病</h4>
                        <div class="yyzx_info">
                            <p class="weui-media-box__desc yyzx_desc">2017年6月6日</p>
                            <div class="weui-media-box__desc yyzx_look">
                                <img src="../images/look.png">191
                            </div>
                        </div>
                    </div>
                    <div class="weui-media-box__hd">
                        <img class="weui-media-box__thumb" src="../images/zixun2.jpg">
                    </div>
                </a>
                <a class="weui-media-box weui-media-box_appmsg" href="营养资讯_详情.html">
                    <div class="weui-media-box__bd">
                        <h4 class="weui-media-box__title yyzx_title">糖尿病心肌病治疗糖尿病心肌病</h4>
                        <div class="yyzx_info">
                            <p class="weui-media-box__desc yyzx_desc">2017年6月6日</p>
                            <div class="weui-media-box__desc yyzx_look">
                                <img src="../images/look.png">191
                            </div>
                        </div>
                    </div>
                    <div class="weui-media-box__hd">
                        <img class="weui-media-box__thumb" src="../images/zixun2.jpg">
                    </div>
                </a>
                <a class="weui-media-box weui-media-box_appmsg" href="营养资讯_详情.html">
                    <div class="weui-media-box__bd">
                        <h4 class="weui-media-box__title yyzx_title">糖尿病心肌病治疗糖尿病心肌病</h4>
                        <div class="yyzx_info">
                            <p class="weui-media-box__desc yyzx_desc">2017年6月6日</p>
                            <div class="weui-media-box__desc yyzx_look">
                                <img src="../images/look.png">191
                            </div>
                        </div>
                    </div>
                    <div class="weui-media-box__hd">
                        <img class="weui-media-box__thumb" src="../images/zixun2.jpg">
                    </div>
                </a>
                <a class="weui-media-box weui-media-box_appmsg" href="营养资讯_详情.html">
                    <div class="weui-media-box__bd">
                        <h4 class="weui-media-box__title yyzx_title">糖尿病心肌病治疗糖尿病心肌病</h4>
                        <div class="yyzx_info">
                            <p class="weui-media-box__desc yyzx_desc">2017年6月6日</p>
                            <div class="weui-media-box__desc yyzx_look">
                                <img src="../images/look.png">191
                            </div>
                        </div>
                    </div>
                    <div class="weui-media-box__hd">
                        <img class="weui-media-box__thumb" src="../images/zixun2.jpg">
                    </div>
                </a>
            </div>
        </div>
        <div id="pullUp">
            <span class="pullUpLabel">上拉加载更多...</span>
        </div>
    </div>
</div>
<script src="../js/zepto.min.js"></script>
<script src="../js/iscroll.js"></script>
<script src="../js/f.js"></script>
<script src="../js/swiper.min.js"></script>
<script>

    $(function() {

        /* 从URL中获取当前的频道 */
        var channel_value = getUrlParam("channel_value");
        if(channel_value == "") {
            channel_value = 0;
        }

        /* 给导航中当前的频道加样式,改变对应的内容 */
        var html = $(".swiper-slide")[channel_value];
        if(!html) {
            $(".swiper-slide").eq(0).addClass("active");
        } else {
            $(html).addClass("active");

            /* 实时改变导航栏的位置 */
            var num = parseInt(channel_value);
            if(num > 3) {
                if(num > $(".swiper-slide").length - 5 ) {
                    $(".swiper-wrapper").css("transform", "translate3d(-"+ 60 * ($(".swiper-slide").length - 5) +"px, 0px, 0px)")
                } else {
                    $(".swiper-wrapper").css("transform", "translate3d(-"+ 55 * num +"px, 0px, 0px)")
                }
            }

            /* 获取对应导航栏的内容 */
        }

        /* 设置头部导航栏 */
        var swiper = new Swiper('.swiper-container', {
            spaceBetween: 20,
            slidesPerView:'auto',
            freeMode: true
        });

        /* 点击编辑（+）按钮跳转到频道编辑页面 */
        $(".edit_channel_btn").on("click", function() {
            location.href = "营养资讯_频道编辑.html?channel_value=" + channel_value;
        })

        //左右滑动内容处理
        var mybody = $("#scroller")[0];
        var width = parseInt($("body").css("width")) * 0.5;
        var startX, startY, moveEndX, moveEndY, X, Y;
        mybody.addEventListener('touchstart', function(e) {
            e.preventDefault();
            startX = e.touches[0].pageX;
            startY = e.touches[0].pageY;

        });
        mybody.addEventListener('touchmove', function(e) {
            e.preventDefault();
            moveEndX = e.changedTouches[0].pageX;
            moveEndY = e.changedTouches[0].pageY;
            X = moveEndX - startX;
            Y = moveEndY - startY;
            channel_value = parseInt(channel_value);
            if ( X > width ) {
                if(channel_value > 0) {
                    location.href = "营养资讯.html?channel_value=" + (channel_value - 1);
                }
            }else if ( X < -width) {
                if(channel_value < $(".swiper-slide").length - 1) {
                    location.href = "营养资讯.html?channel_value=" + (channel_value + 1);
                }
            }
        });

    })

    function getdata() {
        var data = [
            {
                id: "1",
                title: "糖尿病心肌病治疗糖尿病心肌病",
                time: "2017年02月04日",
                name: "付华",
                href: "营养资讯_详情.html",
                look: 2,
                img:"../images/zixun2.jpg"
            }
        ];
        return data;
    }

    f.loaded(getdata(), "yyzxRecord");

    /* 点击频道名称跳转到相对应的频道,参数传点击的频道 */
    function clickTab(value) {
        location.href = "营养资讯.html?channel_value=" + value;
    };

    /* 从Url中获取参数的值 */
    function getUrlParam(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) {
            return unescape(r[2]);
        } else {
            return "";
        }
    }
</script>
</body>
</html>
